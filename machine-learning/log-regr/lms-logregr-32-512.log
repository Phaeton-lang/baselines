2021-04-09 22:31:50.151095: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-09 22:31:50.730664: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer.so.7
2021-04-09 22:31:50.731762: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer_plugin.so.7
2021-04-09 22:31:51.291943: E bazel-out/k8-py2-opt/bin/tensorflow/python/pywrap_tensorflow_internal.cc:5187] (GetBFCAllocatorStats) No GPU device registered. Skipping getting stats

2021-04-09 22:31:51.291965: E bazel-out/k8-py2-opt/bin/tensorflow/python/pywrap_tensorflow_internal.cc:5388] (getPeakBytesActive) - Could not retrieve BFC Allocator Stats
2021-04-09 22:31:51.612131: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-09 22:31:51.614286: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:31:51.614800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:06:00.0 name: TITAN Xp COLLECTORS EDITION computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s
2021-04-09 22:31:51.614815: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-09 22:31:51.614838: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-04-09 22:31:51.615962: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-04-09 22:31:51.616149: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-04-09 22:31:51.617488: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-04-09 22:31:51.618134: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-04-09 22:31:51.618160: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-04-09 22:31:51.618232: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:31:51.618779: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:31:51.619264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-04-09 22:31:51.619513: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2021-04-09 22:31:51.640912: I tensorflow/core/platform/profile_utils/cpu_utils.cc:101] CPU Frequency: 3500335000 Hz
2021-04-09 22:31:51.641371: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56441206aee0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-09 22:31:51.641388: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-09 22:31:51.641538: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:31:51.642187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:06:00.0 name: TITAN Xp COLLECTORS EDITION computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s
2021-04-09 22:31:51.642210: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-09 22:31:51.642222: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-04-09 22:31:51.642238: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-04-09 22:31:51.642250: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-04-09 22:31:51.642262: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-04-09 22:31:51.642274: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-04-09 22:31:51.642284: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-04-09 22:31:51.642329: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:31:51.643042: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:31:51.643660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-04-09 22:31:51.643686: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-09 22:31:52.134347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-09 22:31:52.134380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-04-09 22:31:52.134386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-04-09 22:31:52.134539: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:31:52.135096: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:31:52.135616: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:31:52.136291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11281 MB memory) -> physical GPU (device: 0, name: TITAN Xp COLLECTORS EDITION, pci bus id: 0000:06:00.0, compute capability: 6.1)
2021-04-09 22:31:52.137592: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56442b10ed70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-09 22:31:52.137605: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): TITAN Xp COLLECTORS EDITION, Compute Capability 6.1
2021-04-09 22:31:52.304616: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
x_train shape: (10000, 32, 32)
y_train shape: (10000,)
22:31:52.260855
step: 1, loss: 3.737627, accuracy: 0.623047
peak active bytes(MB): 2.6347312927246094
step: 2, loss: 3.822715, accuracy: 0.669922
peak active bytes(MB): 2.6347312927246094
step: 3, loss: 3.755026, accuracy: 0.677734
peak active bytes(MB): 2.7816925048828125
step: 4, loss: 3.911552, accuracy: 0.697266
peak active bytes(MB): 2.7816925048828125
step: 5, loss: 3.861177, accuracy: 0.710938
peak active bytes(MB): 2.7816925048828125
step: 6, loss: 3.929324, accuracy: 0.675781
peak active bytes(MB): 2.7816925048828125
step: 7, loss: 3.798468, accuracy: 0.685547
peak active bytes(MB): 2.7816925048828125
step: 8, loss: 3.873363, accuracy: 0.707031
peak active bytes(MB): 2.7816925048828125
step: 9, loss: 3.806771, accuracy: 0.685547
peak active bytes(MB): 2.7816925048828125
step: 10, loss: 3.767017, accuracy: 0.669922
peak active bytes(MB): 2.7816925048828125
step: 11, loss: 3.787932, accuracy: 0.689453
peak active bytes(MB): 2.7816925048828125
step: 12, loss: 3.618425, accuracy: 0.609375
peak active bytes(MB): 2.7816925048828125
step: 13, loss: 3.655051, accuracy: 0.667969
peak active bytes(MB): 2.7816925048828125
step: 14, loss: 3.694852, accuracy: 0.671875
peak active bytes(MB): 2.7816925048828125
step: 15, loss: 3.930291, accuracy: 0.693359
peak active bytes(MB): 2.7816925048828125
throughput: 18.0 ms!!!
