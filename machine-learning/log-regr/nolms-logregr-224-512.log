2021-04-09 22:33:00.794835: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-09 22:33:01.347003: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer.so.7
2021-04-09 22:33:01.348123: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer_plugin.so.7
2021-04-09 22:33:17.491346: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-09 22:33:17.493479: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:33:17.493994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:06:00.0 name: TITAN Xp COLLECTORS EDITION computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s
2021-04-09 22:33:17.494009: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-09 22:33:17.494033: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-04-09 22:33:17.495187: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-04-09 22:33:17.495378: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-04-09 22:33:17.496729: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-04-09 22:33:17.497396: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-04-09 22:33:17.497424: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-04-09 22:33:17.497499: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:33:17.498050: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:33:17.498542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-04-09 22:33:17.498802: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2021-04-09 22:33:17.520925: I tensorflow/core/platform/profile_utils/cpu_utils.cc:101] CPU Frequency: 3500335000 Hz
2021-04-09 22:33:17.521491: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559d41690c80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-09 22:33:17.521517: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-09 22:33:17.521688: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:33:17.522429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:06:00.0 name: TITAN Xp COLLECTORS EDITION computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s
2021-04-09 22:33:17.522456: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-09 22:33:17.522470: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-04-09 22:33:17.522505: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-04-09 22:33:17.522533: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-04-09 22:33:17.522560: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-04-09 22:33:17.522587: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-04-09 22:33:17.522602: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-04-09 22:33:17.522664: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:33:17.523404: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:33:17.524084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-04-09 22:33:17.524117: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-09 22:33:18.022514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-09 22:33:18.022547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-04-09 22:33:18.022553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-04-09 22:33:18.022710: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:33:18.023285: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:33:18.023806: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-09 22:33:18.024353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11281 MB memory) -> physical GPU (device: 0, name: TITAN Xp COLLECTORS EDITION, pci bus id: 0000:06:00.0, compute capability: 6.1)
2021-04-09 22:33:18.025830: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559d5a734b50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-09 22:33:18.025843: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): TITAN Xp COLLECTORS EDITION, Compute Capability 6.1
2021-04-09 22:33:19.734457: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
x_train shape: (10000, 224, 224)
y_train shape: (10000,)
22:33:18.144220
step: 1, loss: 3.907867, accuracy: 0.675781
peak active bytes(MB): 136.67431640625
step: 2, loss: 3.867040, accuracy: 0.685547
peak active bytes(MB): 136.87109375
step: 3, loss: 3.888778, accuracy: 0.703125
peak active bytes(MB): 136.87109375
step: 4, loss: 3.812748, accuracy: 0.675781
peak active bytes(MB): 136.87109375
step: 5, loss: 3.817234, accuracy: 0.667969
peak active bytes(MB): 136.87109375
step: 6, loss: 3.945563, accuracy: 0.712891
peak active bytes(MB): 136.87109375
step: 7, loss: 3.833889, accuracy: 0.687500
peak active bytes(MB): 136.87109375
step: 8, loss: 3.865791, accuracy: 0.669922
peak active bytes(MB): 136.87109375
step: 9, loss: 3.771379, accuracy: 0.669922
peak active bytes(MB): 136.87109375
step: 10, loss: 3.794665, accuracy: 0.654297
peak active bytes(MB): 136.87109375
step: 11, loss: 3.939586, accuracy: 0.701172
peak active bytes(MB): 136.87109375
step: 12, loss: 3.812160, accuracy: 0.660156
peak active bytes(MB): 136.87109375
step: 13, loss: 3.919720, accuracy: 0.712891
peak active bytes(MB): 136.87109375
step: 14, loss: 3.817166, accuracy: 0.701172
peak active bytes(MB): 136.87109375
step: 15, loss: 3.945475, accuracy: 0.712891
peak active bytes(MB): 136.87109375
step: 16, loss: 3.906902, accuracy: 0.687500
peak active bytes(MB): 136.87109375
step: 17, loss: 3.848541, accuracy: 0.685547
peak active bytes(MB): 136.87109375
step: 18, loss: 3.793242, accuracy: 0.656250
peak active bytes(MB): 136.87109375
step: 19, loss: 3.819773, accuracy: 0.697266
peak active bytes(MB): 136.87109375
step: 20, loss: 3.712720, accuracy: 0.654297
peak active bytes(MB): 136.87109375
step: 21, loss: 3.757065, accuracy: 0.691406
peak active bytes(MB): 136.87109375
step: 22, loss: 3.780010, accuracy: 0.685547
peak active bytes(MB): 136.87109375
step: 23, loss: 3.732906, accuracy: 0.667969
peak active bytes(MB): 136.87109375
step: 24, loss: 3.715753, accuracy: 0.693359
peak active bytes(MB): 136.87109375
step: 25, loss: 3.864023, accuracy: 0.685547
peak active bytes(MB): 136.87109375
step: 26, loss: 3.847221, accuracy: 0.707031
peak active bytes(MB): 136.87109375
step: 27, loss: 3.729595, accuracy: 0.683594
peak active bytes(MB): 136.87109375
step: 28, loss: 3.824984, accuracy: 0.671875
peak active bytes(MB): 136.87109375
step: 29, loss: 3.743776, accuracy: 0.701172
peak active bytes(MB): 136.87109375
step: 30, loss: 3.606949, accuracy: 0.689453
peak active bytes(MB): 136.87109375
step: 31, loss: 3.857688, accuracy: 0.707031
peak active bytes(MB): 136.87109375
step: 32, loss: 3.720542, accuracy: 0.699219
peak active bytes(MB): 136.87109375
step: 33, loss: 3.850149, accuracy: 0.695312
peak active bytes(MB): 136.87109375
step: 34, loss: 3.759127, accuracy: 0.679688
peak active bytes(MB): 136.87109375
step: 35, loss: 3.805771, accuracy: 0.691406
peak active bytes(MB): 136.87109375
step: 36, loss: 3.653655, accuracy: 0.669922
peak active bytes(MB): 136.87109375
step: 37, loss: 3.702053, accuracy: 0.669922
peak active bytes(MB): 136.87109375
step: 38, loss: 3.684281, accuracy: 0.689453
peak active bytes(MB): 136.87109375
step: 39, loss: 3.722024, accuracy: 0.660156
peak active bytes(MB): 136.87109375
step: 40, loss: 3.729288, accuracy: 0.683594
peak active bytes(MB): 136.87109375
throughput: 131.35 ms!!!
