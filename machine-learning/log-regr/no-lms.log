2021-04-06 19:50:59.771989: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-06 19:51:00.360611: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer.so.7
2021-04-06 19:51:00.361587: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer_plugin.so.7
2021-04-06 19:51:28.907278: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-06 19:51:28.909604: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 19:51:28.910143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:06:00.0 name: TITAN Xp COLLECTORS EDITION computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s
2021-04-06 19:51:28.910166: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-06 19:51:28.910195: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-04-06 19:51:28.911451: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-04-06 19:51:28.911676: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-04-06 19:51:28.913146: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-04-06 19:51:28.913863: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-04-06 19:51:28.913894: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-04-06 19:51:28.913960: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 19:51:28.914526: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 19:51:28.915016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-04-06 19:51:28.915281: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2021-04-06 19:51:28.936917: I tensorflow/core/platform/profile_utils/cpu_utils.cc:101] CPU Frequency: 3500335000 Hz
2021-04-06 19:51:28.937473: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55853ac18000 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-06 19:51:28.937502: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-06 19:51:28.937667: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 19:51:28.938486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:06:00.0 name: TITAN Xp COLLECTORS EDITION computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s
2021-04-06 19:51:28.938511: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-06 19:51:28.938526: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-04-06 19:51:28.938543: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-04-06 19:51:28.938558: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-04-06 19:51:28.938571: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-04-06 19:51:28.938584: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-04-06 19:51:28.938596: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-04-06 19:51:28.938663: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 19:51:28.939503: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 19:51:28.940299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-04-06 19:51:28.940332: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-04-06 19:51:29.449787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-06 19:51:29.449819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-04-06 19:51:29.449828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-04-06 19:51:29.449979: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 19:51:29.450517: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 19:51:29.451028: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-06 19:51:29.451529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11281 MB memory) -> physical GPU (device: 0, name: TITAN Xp COLLECTORS EDITION, pci bus id: 0000:06:00.0, compute capability: 6.1)
2021-04-06 19:51:29.452989: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558553cbba40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-06 19:51:29.453003: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): TITAN Xp COLLECTORS EDITION, Compute Capability 6.1
2021-04-06 19:51:29.578720: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 3600000000 exceeds 10% of system memory.
2021-04-06 19:51:33.381479: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 2949120000 exceeds 10% of system memory.
2021-04-06 19:51:34.484228: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-04-06 19:51:35.474677: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 2949120000 exceeds 10% of system memory.
2021-04-06 19:51:38.026953: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 2949120000 exceeds 10% of system memory.
2021-04-06 19:51:40.636853: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 2949120000 exceeds 10% of system memory.
x_train shape: (10000, 300, 300)
y_train shape: (10000,)
19:51:29.577351
step: 1, loss: 3.843779, accuracy: 0.680176
peak active bytes(MB): 2887.4169921875
step: 2, loss: 3.825507, accuracy: 0.683716
peak active bytes(MB): 2890.54345703125
step: 3, loss: 3.842068, accuracy: 0.684448
peak active bytes(MB): 2890.54345703125
step: 4, loss: 3.832874, accuracy: 0.681274
peak active bytes(MB): 2890.54345703125
step: 5, loss: 3.836439, accuracy: 0.684814
peak active bytes(MB): 2890.54345703125
throughput: 3336.2 ms!!!
